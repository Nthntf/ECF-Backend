{% extends "layout/layout.html.twig" %}

{% block content %}
	<article class="bg-white rounded-2xl shadow-lg mx-auto my-8 p-6 max-w-7xl">

		<div class="flex justify-between items-center mb-6">
			<h1 class="text-2xl font-bold text-stone-700">
				Auteurs
			</h1>

			{% if role === 'admin' %}
				<button type="button" class="add-btn open-modal" data-resource="authors" data-modal="add">
					+ Ajouter un auteur
				</button>
			{% endif %}
		</div>

		<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
			{% for author in auteurs %}
				<div class="bg-stone-50 rounded-2xl border border-stone-200 shadow-sm
																	   hover:shadow-md transition p-6 flex flex-col">

					{% if role === 'admin' %}
						<div class="flex justify-end gap-2 mb-3">
							<button class="update-btn open-modal" data-resource="authors" data-modal="update" data-id="{{ author.id }}" data-prenom="{{ author.prenom }}" data-nom="{{ author.nom }}" data-biographie="{{ author.biographie|e('html_attr') }}">
								Modifier
							</button>

							<button type="button" class="delete-btn open-modal" data-resource="authors" data-modal="delete" data-id="{{ author.id }}" data-fullname="{{ author.prenom }} {{ author.nom }}">
								Supprimer
							</button>
						</div>
					{% endif %}

					<h2 class="text-xl font-semibold text-stone-800 mb-3">
						{{ author.prenom }}
						{{ author.nom }}
					</h2>

					<div class="text-sm text-stone-600 leading-relaxed overflow-y-auto max-h-40 pr-1">
						{{ author.biographie|raw }}
					</div>
				</div>
			{% else %}
				<p class="text-stone-500">
					Aucun auteur trouvé
				</p>
			{% endfor %}
		</div>
	</article>


	{% if role === 'admin' %}
		<!-- Modal Ajouter -->
		<div id="modal-add" class="hidden modal fixed inset-0 bg-black/50 items-center justify-center">
			<form method="POST" class="bg-white rounded p-6 w-96" id="addForm">
				<input type="text" name="prenom" placeholder="Prénom" class="border w-full my-1 px-2 py-1" required>
				<input type="text" name="nom" placeholder="Nom" class="border w-full my-1 px-2 py-1" required>
				<textarea name="biographie" placeholder="Biographie" class="border w-full my-1 px-2 py-1" required></textarea>

				<div class="flex justify-end gap-2 mt-4">
					<button type="button" class="cancel-btn close-modal">Annuler</button>
					<button class="add-btn">Ajouter</button>
				</div>
			</form>
		</div>

		<!-- Modal Supprimer -->
		<div id="modal-delete" class="hidden modal fixed inset-0 bg-black/50 items-center justify-center">
			<form method="POST" class="bg-white rounded p-6 w-96" id="deleteForm">
				<p class="delete-msg"></p>
				<div class="flex justify-end gap-2 mt-4">
					<button type="button" class="cancel-btn close-modal">Annuler</button>
					<button class="delete-btn">Supprimer</button>
				</div>
			</form>
		</div>

		<!-- Modal Modifier -->
		<div id="modal-update" class="hidden modal fixed inset-0 bg-black/50 items-center justify-center">
			<form method="POST" class="bg-white rounded p-6 w-96" id="updateForm">
				<input type="text" name="prenom" id="updatePrenom" class="border w-full my-1 px-2 py-1" required>
				<input type="text" name="nom" id="updateNom" class="border w-full my-1 px-2 py-1" required>
				<textarea name="biographie" id="updateBiographie" class="border w-full my-1 px-2 py-1" required></textarea>

				<div class="flex justify-end gap-2 mt-4">
					<button type="button" class="cancel-btn close-modal">Annuler</button>
					<button class="add-btn">Confirmer</button>
				</div>
			</form>
		</div>
	{% endif %}
{% endblock %}
