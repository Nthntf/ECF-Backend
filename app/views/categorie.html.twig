{% extends "layout/layout.html.twig" %}

{% block content %}
	<article class="bg-white rounded-2xl shadow-lg mx-auto max-w-4xl my-8 p-6">
		<div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6">
			<h1 class="text-2xl font-bold text-stone-700">
				Catégories
			</h1>

			<div class="flex items-center gap-3">
				{% if role === 'admin' %}
					<button type="button" class="add-btn open-modal" data-resource="categories" data-modal="add">
						+ Ajouter une catégorie
					</button>
				{% endif %}
			</div>
		</div>

		<div class="overflow-hidden rounded-xl border border-stone-200">
			<table class="min-w-full text-sm">
				<thead class="bg-stone-100 text-stone-700">
					<tr>
						<th class="px-6 py-3 text-left font-semibold">ID</th>
						<th class="px-6 py-3 text-left font-semibold">Nom</th>

						{% if role === 'admin' %}
							<th class="px-6 py-3 text-center font-semibold">Modifier</th>
							<th class="px-6 py-3 text-center font-semibold">Supprimer</th>
						{% endif %}
					</tr>
				</thead>

				<tbody class="divide-y divide-stone-200">
					{% for categorie in categories %}
						<tr class="hover:bg-stone-50 transition">
							<td class="px-6 py-2.5 font-medium text-stone-700">
								{{ categorie.id }}
							</td>
							<td class="px-6 py-2.5">
								{{ categorie.nom }}
							</td>

							{% if role === 'admin' %}
								<td class="px-6 py-2.5 text-center">
									<button class="update-btn open-modal" data-resource="categories" data-modal="update" data-id="{{ categorie.id }}" data-nom="{{ categorie.nom }}">
										Modifier
									</button>
								</td>

								<td class="px-6 py-2.5 text-center">
									<button type="button" class="delete-btn open-modal" data-resource="categories" data-modal="delete" data-id="{{ categorie.id }}" data-nom="{{ categorie.nom }}">
										Supprimer
									</button>
								</td>
							{% endif %}
						</tr>
					{% else %}
						<tr>
							<td colspan="4" class="px-6 py-6 text-center text-stone-500">
								Aucune catégorie trouvée
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</article>
	{% if role === 'admin' %}
		<!-- Modal Ajouter -->
		<div id="modal-add" class="hidden modal fixed inset-0 bg-black/50 items-center justify-center">
			<form action="" method="POST" class="bg-white rounded p-6 w-96" id="addForm">
				<input type="text" name="nom" class="border-2 border-gray-300 px-3 py-1 my-1 w-full" placeholder="Nom catégorie" required>
				<div class="flex justify-end gap-2 mt-4">
					<button type="button" class="cancel-btn close-modal">Annuler</button>
					<button class="add-btn">Ajouter</button>
				</div>
			</form>
		</div>
		<!-- Modal Supprimer -->
		<div id="modal-delete" class="hidden modal fixed inset-0 bg-black/50 items-center justify-center">
			<form action="" method="POST" class="bg-white rounded p-6 w-96" id="deleteForm">
				<p class="delete-msg"></p>
				<div class="flex justify-end gap-2 mt-4">
					<button type="button" class="cancel-btn close-modal">Annuler</button>
					<button class="delete-btn">Supprimer</button>
				</div>
			</form>
		</div>
		<!-- Modal Modifier -->
		<div id="modal-update" class="hidden modal fixed inset-0 bg-black/50 items-center justify-center">
			<form action="" method="POST" class="bg-white rounded p-6 w-96" id="updateForm">
				<input type="text" name="nom" id="updateNom" class="border-2 border-gray-300 px-3 py-1 my-1 w-full" required>
				<div class="flex justify-end gap-2 mt-4">
					<button type="button" class="cancel-btn close-modal">Annuler</button>
					<button class="add-btn">Confirmer</button>
				</div>
			</form>
		</div>
	{% endif %}
{% endblock %}
